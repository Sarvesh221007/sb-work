{"ast":null,"code":"import React,{useEffect,useState}from'react';import api from'../../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function MyProjects(){const[projects,setProjects]=useState([]);const token=localStorage.getItem('token');const fetchProjects=async()=>{if(!token)return;try{const res=await api.get('/api/projects/my',{headers:{Authorization:\"Bearer \".concat(token)}});console.log('Fetched projects:',res.data);setProjects(res.data);}catch(err){console.error('Failed to fetch projects:',err);}};useEffect(()=>{fetchProjects();},[]);const selectFreelancer=async(projectId,freelancerId)=>{try{await api.post(\"/api/projects/\".concat(projectId,\"/select\"),{freelancerId},{headers:{Authorization:\"Bearer \".concat(token)}});alert('Freelancer selected!');fetchProjects();}catch(err){var _err$response,_err$response$data;alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.msg)||'Error selecting freelancer');}};const handleFeedbackSubmit=async(e,projectId)=>{e.preventDefault();const{message,rating}=e.target;try{await api.post(\"/api/projects/\".concat(projectId,\"/feedback\"),{message:message.value,rating:parseInt(rating.value)},{headers:{Authorization:\"Bearer \".concat(token)}});alert('Feedback submitted successfully');fetchProjects();}catch(err){var _err$response2,_err$response2$data;alert(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.msg)||'Error submitting feedback');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container py-5 my-5\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center mb-4 fw-bold\",children:\"My Posted Projects\"}),projects.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-muted\",children:\"You haven\\u2019t posted any projects yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:projects.map(p=>/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 mb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card shadow h-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"card-title\",children:p.title}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:p.description}),/*#__PURE__*/_jsx(\"h5\",{className:\"mt-4\",children:\"Bids\"}),p.bids.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"No bids yet.\"}):p.bids.map(bid=>{var _bid$freelancer;return/*#__PURE__*/_jsxs(\"div\",{className:\"border-bottom pb-2 mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:(_bid$freelancer=bid.freelancer)===null||_bid$freelancer===void 0?void 0:_bid$freelancer.name}),\" \\u2013 \\u20B9\",bid.amount,/*#__PURE__*/_jsx(\"p\",{className:\"mb-1\",children:bid.message}),!p.selectedFreelancer&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-success\",onClick:()=>selectFreelancer(p._id,bid.freelancer._id),children:\"Select Freelancer\"})]},bid._id);}),p.isSubmitted&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-info mt-3\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Submitted Work:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-0\",children:p.submission})]}),p.isSubmitted&&!p.feedback&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>handleFeedbackSubmit(e,p._id),className:\"mt-3\",children:[/*#__PURE__*/_jsx(\"textarea\",{name:\"message\",className:\"form-control my-2\",placeholder:\"Write feedback message\",required:true}),/*#__PURE__*/_jsxs(\"select\",{name:\"rating\",className:\"form-select my-2\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Rating\"}),[1,2,3,4,5].map(r=>/*#__PURE__*/_jsxs(\"option\",{value:r,children:[r,\" Star\"]},r))]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary w-100\",children:\"Submit Feedback\"})]}),p.feedback&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3\",children:[/*#__PURE__*/_jsx(\"h6\",{children:\"Feedback:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-1\",children:p.feedback.message}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-warning mb-0\",children:[\"Rating: \",'★'.repeat(p.feedback.rating),'☆'.repeat(5-p.feedback.rating)]})]}),p.selectedFreelancer&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 text-success\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Freelancer Selected\"})})]})})},p._id))})]});}","map":{"version":3,"names":["React","useEffect","useState","api","jsx","_jsx","jsxs","_jsxs","MyProjects","projects","setProjects","token","localStorage","getItem","fetchProjects","res","get","headers","Authorization","concat","console","log","data","err","error","selectFreelancer","projectId","freelancerId","post","alert","_err$response","_err$response$data","response","msg","handleFeedbackSubmit","e","preventDefault","message","rating","target","value","parseInt","_err$response2","_err$response2$data","className","children","length","map","p","title","description","bids","bid","_bid$freelancer","freelancer","name","amount","selectedFreelancer","onClick","_id","isSubmitted","submission","feedback","onSubmit","placeholder","required","r","repeat"],"sources":["C:/Users/sarve/OneDrive/Desktop/sb-works/client/src/components/project/MyProjects.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport api from '../../api';\r\n\r\nexport default function MyProjects() {\r\n  const [projects, setProjects] = useState([]);\r\n  const token = localStorage.getItem('token');\r\n\r\n  const fetchProjects = async () => {\r\n    if (!token) return;\r\n    try {\r\n      const res = await api.get('/api/projects/my', {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      console.log('Fetched projects:', res.data);\r\n      setProjects(res.data);\r\n    } catch (err) {\r\n      console.error('Failed to fetch projects:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProjects();\r\n  }, []);\r\n\r\n  const selectFreelancer = async (projectId, freelancerId) => {\r\n    try {\r\n      await api.post(`/api/projects/${projectId}/select`, { freelancerId }, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      alert('Freelancer selected!');\r\n      fetchProjects();\r\n    } catch (err) {\r\n      alert(err.response?.data?.msg || 'Error selecting freelancer');\r\n    }\r\n  };\r\n\r\n  const handleFeedbackSubmit = async (e, projectId) => {\r\n    e.preventDefault();\r\n    const { message, rating } = e.target;\r\n\r\n    try {\r\n      await api.post(`/api/projects/${projectId}/feedback`, {\r\n        message: message.value,\r\n        rating: parseInt(rating.value),\r\n      }, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      alert('Feedback submitted successfully');\r\n      fetchProjects();\r\n    } catch (err) {\r\n      alert(err.response?.data?.msg || 'Error submitting feedback');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container py-5 my-5\">\r\n      <h2 className=\"text-center mb-4 fw-bold\">My Posted Projects</h2>\r\n\r\n      {projects.length === 0 ? (\r\n        <p className=\"text-center text-muted\">You haven’t posted any projects yet.</p>\r\n      ) : (\r\n        <div className=\"row\">\r\n          {projects.map((p) => (\r\n            <div key={p._id} className=\"col-md-6 mb-4\">\r\n              <div className=\"card shadow h-100\">\r\n                <div className=\"card-body\">\r\n                  <h4 className=\"card-title\">{p.title}</h4>\r\n                  <p className=\"card-text\">{p.description}</p>\r\n\r\n                  <h5 className=\"mt-4\">Bids</h5>\r\n                  {p.bids.length === 0 ? (\r\n                    <p className=\"text-muted\">No bids yet.</p>\r\n                  ) : (\r\n                    p.bids.map((bid) => (\r\n                      <div key={bid._id} className=\"border-bottom pb-2 mb-2\">\r\n                        <strong>{bid.freelancer?.name}</strong> – ₹{bid.amount}\r\n                        <p className=\"mb-1\">{bid.message}</p>\r\n                        {!p.selectedFreelancer && (\r\n                          <button\r\n                            className=\"btn btn-sm btn-outline-success\"\r\n                            onClick={() => selectFreelancer(p._id, bid.freelancer._id)}\r\n                          >\r\n                            Select Freelancer\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    ))\r\n                  )}\r\n\r\n                  {p.isSubmitted && (\r\n                    <div className=\"alert alert-info mt-3\">\r\n                      <strong>Submitted Work:</strong>\r\n                      <p className=\"mb-0\">{p.submission}</p>\r\n                    </div>\r\n                  )}\r\n\r\n                  {p.isSubmitted && !p.feedback && (\r\n                    <form onSubmit={(e) => handleFeedbackSubmit(e, p._id)} className=\"mt-3\">\r\n                      <textarea\r\n                        name=\"message\"\r\n                        className=\"form-control my-2\"\r\n                        placeholder=\"Write feedback message\"\r\n                        required\r\n                      />\r\n                      <select name=\"rating\" className=\"form-select my-2\" required>\r\n                        <option value=\"\">Select Rating</option>\r\n                        {[1, 2, 3, 4, 5].map((r) => (\r\n                          <option key={r} value={r}>{r} Star</option>\r\n                        ))}\r\n                      </select>\r\n                      <button className=\"btn btn-primary w-100\">Submit Feedback</button>\r\n                    </form>\r\n                  )}\r\n\r\n                  {p.feedback && (\r\n                    <div className=\"mt-3\">\r\n                      <h6>Feedback:</h6>\r\n                      <p className=\"mb-1\">{p.feedback.message}</p>\r\n                      <p className=\"text-warning mb-0\">\r\n                        Rating: {'★'.repeat(p.feedback.rating)}{'☆'.repeat(5 - p.feedback.rating)}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n\r\n                  {p.selectedFreelancer && (\r\n                    <p className=\"mt-3 text-success\">\r\n                      <strong>Freelancer Selected</strong>\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,GAAG,KAAM,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5B,cAAe,SAAS,CAAAC,UAAUA,CAAA,CAAG,CACnC,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGR,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAAAS,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,KAAM,CAAAC,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CAACH,KAAK,CAAE,OACZ,GAAI,CACF,KAAM,CAAAI,GAAG,CAAG,KAAM,CAAAZ,GAAG,CAACa,GAAG,CAAC,kBAAkB,CAAE,CAC5CC,OAAO,CAAE,CAAEC,aAAa,WAAAC,MAAA,CAAYR,KAAK,CAAG,CAC9C,CAAC,CAAC,CACFS,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAEN,GAAG,CAACO,IAAI,CAAC,CAC1CZ,WAAW,CAACK,GAAG,CAACO,IAAI,CAAC,CACvB,CAAE,MAAOC,GAAG,CAAE,CACZH,OAAO,CAACI,KAAK,CAAC,2BAA2B,CAAED,GAAG,CAAC,CACjD,CACF,CAAC,CAEDtB,SAAS,CAAC,IAAM,CACda,aAAa,CAAC,CAAC,CACjB,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAW,gBAAgB,CAAG,KAAAA,CAAOC,SAAS,CAAEC,YAAY,GAAK,CAC1D,GAAI,CACF,KAAM,CAAAxB,GAAG,CAACyB,IAAI,kBAAAT,MAAA,CAAkBO,SAAS,YAAW,CAAEC,YAAa,CAAC,CAAE,CACpEV,OAAO,CAAE,CAAEC,aAAa,WAAAC,MAAA,CAAYR,KAAK,CAAG,CAC9C,CAAC,CAAC,CACFkB,KAAK,CAAC,sBAAsB,CAAC,CAC7Bf,aAAa,CAAC,CAAC,CACjB,CAAE,MAAOS,GAAG,CAAE,KAAAO,aAAA,CAAAC,kBAAA,CACZF,KAAK,CAAC,EAAAC,aAAA,CAAAP,GAAG,CAACS,QAAQ,UAAAF,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcR,IAAI,UAAAS,kBAAA,iBAAlBA,kBAAA,CAAoBE,GAAG,GAAI,4BAA4B,CAAC,CAChE,CACF,CAAC,CAED,KAAM,CAAAC,oBAAoB,CAAG,KAAAA,CAAOC,CAAC,CAAET,SAAS,GAAK,CACnDS,CAAC,CAACC,cAAc,CAAC,CAAC,CAClB,KAAM,CAAEC,OAAO,CAAEC,MAAO,CAAC,CAAGH,CAAC,CAACI,MAAM,CAEpC,GAAI,CACF,KAAM,CAAApC,GAAG,CAACyB,IAAI,kBAAAT,MAAA,CAAkBO,SAAS,cAAa,CACpDW,OAAO,CAAEA,OAAO,CAACG,KAAK,CACtBF,MAAM,CAAEG,QAAQ,CAACH,MAAM,CAACE,KAAK,CAC/B,CAAC,CAAE,CACDvB,OAAO,CAAE,CAAEC,aAAa,WAAAC,MAAA,CAAYR,KAAK,CAAG,CAC9C,CAAC,CAAC,CACFkB,KAAK,CAAC,iCAAiC,CAAC,CACxCf,aAAa,CAAC,CAAC,CACjB,CAAE,MAAOS,GAAG,CAAE,KAAAmB,cAAA,CAAAC,mBAAA,CACZd,KAAK,CAAC,EAAAa,cAAA,CAAAnB,GAAG,CAACS,QAAQ,UAAAU,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcpB,IAAI,UAAAqB,mBAAA,iBAAlBA,mBAAA,CAAoBV,GAAG,GAAI,2BAA2B,CAAC,CAC/D,CACF,CAAC,CAED,mBACE1B,KAAA,QAAKqC,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAClCxC,IAAA,OAAIuC,SAAS,CAAC,0BAA0B,CAAAC,QAAA,CAAC,oBAAkB,CAAI,CAAC,CAE/DpC,QAAQ,CAACqC,MAAM,GAAK,CAAC,cACpBzC,IAAA,MAAGuC,SAAS,CAAC,wBAAwB,CAAAC,QAAA,CAAC,2CAAoC,CAAG,CAAC,cAE9ExC,IAAA,QAAKuC,SAAS,CAAC,KAAK,CAAAC,QAAA,CACjBpC,QAAQ,CAACsC,GAAG,CAAEC,CAAC,eACd3C,IAAA,QAAiBuC,SAAS,CAAC,eAAe,CAAAC,QAAA,cACxCxC,IAAA,QAAKuC,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAChCtC,KAAA,QAAKqC,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBxC,IAAA,OAAIuC,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAEG,CAAC,CAACC,KAAK,CAAK,CAAC,cACzC5C,IAAA,MAAGuC,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAEG,CAAC,CAACE,WAAW,CAAI,CAAC,cAE5C7C,IAAA,OAAIuC,SAAS,CAAC,MAAM,CAAAC,QAAA,CAAC,MAAI,CAAI,CAAC,CAC7BG,CAAC,CAACG,IAAI,CAACL,MAAM,GAAK,CAAC,cAClBzC,IAAA,MAAGuC,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,cAAY,CAAG,CAAC,CAE1CG,CAAC,CAACG,IAAI,CAACJ,GAAG,CAAEK,GAAG,OAAAC,eAAA,oBACb9C,KAAA,QAAmBqC,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACpDxC,IAAA,WAAAwC,QAAA,EAAAQ,eAAA,CAASD,GAAG,CAACE,UAAU,UAAAD,eAAA,iBAAdA,eAAA,CAAgBE,IAAI,CAAS,CAAC,iBAAI,CAACH,GAAG,CAACI,MAAM,cACtDnD,IAAA,MAAGuC,SAAS,CAAC,MAAM,CAAAC,QAAA,CAAEO,GAAG,CAACf,OAAO,CAAI,CAAC,CACpC,CAACW,CAAC,CAACS,kBAAkB,eACpBpD,IAAA,WACEuC,SAAS,CAAC,gCAAgC,CAC1Cc,OAAO,CAAEA,CAAA,GAAMjC,gBAAgB,CAACuB,CAAC,CAACW,GAAG,CAAEP,GAAG,CAACE,UAAU,CAACK,GAAG,CAAE,CAAAd,QAAA,CAC5D,mBAED,CAAQ,CACT,GAVOO,GAAG,CAACO,GAWT,CAAC,EACP,CACF,CAEAX,CAAC,CAACY,WAAW,eACZrD,KAAA,QAAKqC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpCxC,IAAA,WAAAwC,QAAA,CAAQ,iBAAe,CAAQ,CAAC,cAChCxC,IAAA,MAAGuC,SAAS,CAAC,MAAM,CAAAC,QAAA,CAAEG,CAAC,CAACa,UAAU,CAAI,CAAC,EACnC,CACN,CAEAb,CAAC,CAACY,WAAW,EAAI,CAACZ,CAAC,CAACc,QAAQ,eAC3BvD,KAAA,SAAMwD,QAAQ,CAAG5B,CAAC,EAAKD,oBAAoB,CAACC,CAAC,CAAEa,CAAC,CAACW,GAAG,CAAE,CAACf,SAAS,CAAC,MAAM,CAAAC,QAAA,eACrExC,IAAA,aACEkD,IAAI,CAAC,SAAS,CACdX,SAAS,CAAC,mBAAmB,CAC7BoB,WAAW,CAAC,wBAAwB,CACpCC,QAAQ,MACT,CAAC,cACF1D,KAAA,WAAQgD,IAAI,CAAC,QAAQ,CAACX,SAAS,CAAC,kBAAkB,CAACqB,QAAQ,MAAApB,QAAA,eACzDxC,IAAA,WAAQmC,KAAK,CAAC,EAAE,CAAAK,QAAA,CAAC,eAAa,CAAQ,CAAC,CACtC,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAACE,GAAG,CAAEmB,CAAC,eACrB3D,KAAA,WAAgBiC,KAAK,CAAE0B,CAAE,CAAArB,QAAA,EAAEqB,CAAC,CAAC,OAAK,GAArBA,CAA6B,CAC3C,CAAC,EACI,CAAC,cACT7D,IAAA,WAAQuC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAAC,iBAAe,CAAQ,CAAC,EAC9D,CACP,CAEAG,CAAC,CAACc,QAAQ,eACTvD,KAAA,QAAKqC,SAAS,CAAC,MAAM,CAAAC,QAAA,eACnBxC,IAAA,OAAAwC,QAAA,CAAI,WAAS,CAAI,CAAC,cAClBxC,IAAA,MAAGuC,SAAS,CAAC,MAAM,CAAAC,QAAA,CAAEG,CAAC,CAACc,QAAQ,CAACzB,OAAO,CAAI,CAAC,cAC5C9B,KAAA,MAAGqC,SAAS,CAAC,mBAAmB,CAAAC,QAAA,EAAC,UACvB,CAAC,GAAG,CAACsB,MAAM,CAACnB,CAAC,CAACc,QAAQ,CAACxB,MAAM,CAAC,CAAE,GAAG,CAAC6B,MAAM,CAAC,CAAC,CAAGnB,CAAC,CAACc,QAAQ,CAACxB,MAAM,CAAC,EACxE,CAAC,EACD,CACN,CAEAU,CAAC,CAACS,kBAAkB,eACnBpD,IAAA,MAAGuC,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAC9BxC,IAAA,WAAAwC,QAAA,CAAQ,qBAAmB,CAAQ,CAAC,CACnC,CACJ,EACE,CAAC,CACH,CAAC,EAnEEG,CAAC,CAACW,GAoEP,CACN,CAAC,CACC,CACN,EACE,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}